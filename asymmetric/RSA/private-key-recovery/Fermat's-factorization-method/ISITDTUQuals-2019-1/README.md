# Easy RSA 2

#### ISITDTU 2019 

### Условия задания

Дан файл с кодом [task.py]( task.py).

Требуется получить флаг.

### Уязвимость
Исходя из файла задания, модуль n и закрытая экспонента d генерируются следующим кодом:
```
p1 = getPrime ( 512 ) 
p2 = gmpy2.next_prime (p1) 
q1 = getPrime ( 512 ) 
q2 = gmpy2.next_prime (q1) 
n = p1 * p2 * q1 * q2 
phi = (p1 -  1 ) * (p2 -  1 ) * (q1 -  1 ) * (q2 -  1 ) 
d = gmpy2.invert (e, phi)
```

При этом простые числа `p1`, `p2`, `q1`, `q2` [близки по значению](Weger02.pdf), а это значит, что значения произведений `p1 * p2`, `q1 * q2`, `p1 * q2`,  `p2 * q1` также близки. Если случайные числа `p`, `q`, произведение которых равно `n`, близки друг к другу, то они могут быть найдены [методом факторизации Ферма](0910.4179v1.pdf). После чего можно найти секретную экспоненту `d`, взломав таким образом RSA. Методом факторизации n можно получить значения `p1 * q1`, `p1 * q2`, `p2 * q1`, `p2 * q2`. Вычисляя НОД произведений, можно восстановить простые множители. 
 
Решение: [solve.py](solve.py).
