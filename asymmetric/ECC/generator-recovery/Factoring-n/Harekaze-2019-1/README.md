# Show me your private key

#### Harekaze - 2019

### Условия задания

Дан файл с кодом [problem.sage](problem.sage)

Требуется найти флаг.

### Уязвимость

Из кода задания известно, что была сгенерирована пара ключей и даны параметры: `n`, `e`, `d`. 
Затем была создана эллиптическая кривая, в которой точка, определенная через координаты `Gx` и `Gy` 
вычисляются таким образом: `Gy^2 = Gx^3 + b mod n`, затем эти координаты шифруются возведением `G` в степень `e`. 
Координаты `Сx`, `Сy`, получившейся при этом точки `C`, известны. Также можно найти значение b так как точка `(Cx, Cy)` также находится на данной кривой. 

Чтобы получить значение точки `G` из точки `C` требуется обратное значение `e`, для этого необходимо выяснить порядок кривой (#EC). 
Однако, `n` – составное число, поэтому для начала требуется найти его делители `p`, `q`. Т.к. известен секретный ключ `d`, 
можно разложить `n = p * q` и [найти порядок](Kunihiro-Koyama1998_Chapter_EquivaleNceOfCouNtiNgTheNumber.pdf) кривой
из соотношения: `#EC_n = #EC_p * #EC_q`. 

Решение: [solve.sage](solve.sage)
